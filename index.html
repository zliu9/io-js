<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Io-js : Javascript IO library" />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Io-js</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/zliu9/io-js">View on GitHub</a>

          <h1 id="project_title">Io-js</h1>
          <h2 id="project_tagline">Javascript IO library</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/zliu9/io-js/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/zliu9/io-js/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a name="iot-io-library" class="anchor" href="#iot-io-library"><span class="octicon octicon-link"></span></a>IOT IO Library</h1>

<p>A unified IO Javascript library for IOT device(Galileo/Edison), companion device(phone/tablet) and XDK.</p>

<h2>
<a name="features" class="anchor" href="#features"><span class="octicon octicon-link"></span></a>Features</h2>

<ul>
<li>Arduino like API</li>
<li>Unified API for nodejs and browser</li>
<li>Standard JSON-RPC 2.0 support</li>
<li>Offload execution</li>
<li>Autogen tools for customized IO functions</li>
</ul><h2>
<a name="preinstall" class="anchor" href="#preinstall"><span class="octicon octicon-link"></span></a>PreInstall</h2>

<ul>
<li>This library can run correctly both on Intel dev kit <a href="https://software.intel.com/en-us/iotdevkit">https://software.intel.com/en-us/iotdevkit</a> which contains host a machine running DevKit Live USB image and target Intel Galileo platform. This IO library can run on both of them. Below is a quick guide of how to enable nodejs on host and target. </li>
</ul><h3>
<a name="install-yocoto-on-galileo" class="anchor" href="#install-yocoto-on-galileo"><span class="octicon octicon-link"></span></a>Install yocoto on galileo</h3>

<ul>
<li><p><a href="http://iotdk.intel.com/images/iot-devkit-201402201605-mmcblkp0.direct.bz2">Download SD card image (200M)</a></p></li>
<li><p>Uncompress image &amp; recover image to micro sd card with <code>dd</code> cmd</p></li>
</ul><div class="highlight highlight-bash"><pre>dd <span class="k">if</span><span class="o">=</span>/path/to/image  <span class="nv">of</span><span class="o">=</span>/sd/dev/path <span class="nv">bs</span><span class="o">=</span>1M
</pre></div>

<ul>
<li><p>insert SD card to galileo, then power on galileo </p></li>
<li><p>ssh login</p></li>
</ul><div class="highlight highlight-bash"><pre>ssh root@ip_address_for_galileo
</pre></div>

<ul>
<li>check node/node-gyp/npm

<ul>
<li>If not in $PATH, please find it under root directory, then create  symbol link for it. for example,</li>
</ul>
</li>
</ul><div class="highlight highlight-bash"><pre>ln -s /usr/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js /usr/bin/node-gyp
</pre></div>

<ul>
<li><p>Make sure Galileo system is set correctly.</p></li>
<li><p>copy io-js to galileo, then you can jump to <code>Installation</code> section. But the installation is very slow on Galileo. You may want to compile the library on host machine with cross compiler</p></li>
</ul><h3>
<a name="install-devkit-live-image-on-host-machine" class="anchor" href="#install-devkit-live-image-on-host-machine"><span class="octicon octicon-link"></span></a>Install devkit live image on host machine</h3>

<ul>
<li>
<p>Download iot dev kit image (4.2G)</p>

<ul>
<li><a href="https://software.intel.com/sites/landingpage/iotdk/devkit-live-img-final.binblob.bz2">devkit-live-img-final.binblob.bz2</a></li>
</ul>
</li>
<li><p>Although devkit officially suggest to use it as bootable USB key, but we suggest you to boot it in virtual machine.</p></li>
<li>
<p>Download &amp; Install Virtual box</p>

<ul>
<li><a href="https://www.virtualbox.org/wiki/Downloads">Refer to virtual box official website</a></li>
</ul>
</li>
<li>uncompress image &amp; convert image to virtual box image</li>
</ul><div class="highlight highlight-bash"><pre>vboxmanage convertfromraw --format VMDK devkit-live-img-final.binblob ~/devkit.vmdk
</pre></div>

<ul>
<li><p>Boot up devkit.vmdk in virtual box</p></li>
<li><p>login virtual machine</p></li>
<li>
<p>check node/node-gyp/npm</p>

<ul>
<li>If not under $PATH, please find it under root directory, then create  symbol link for it. for example,</li>
</ul>
</li>
</ul><div class="highlight highlight-bash"><pre>  ln -s /opt/iot-devkit/1.5.1/yocto/sysroots/i586-poky-linux/usr/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js /usr/bin/node-gyp
</pre></div>

<ul>
<li>copy io-js to devkit, then run it followed <code>Installation</code> part. </li>
</ul><h2>
<a name="installation" class="anchor" href="#installation"><span class="octicon octicon-link"></span></a>Installation</h2>

<p>npm install
  (if run <code>io-js</code> as root, please use "npm install -unsafe-perm" instead)</p>

<h2>
<a name="examples" class="anchor" href="#examples"><span class="octicon octicon-link"></span></a>Examples</h2>

<ul>
<li>Native IO operation on IOT device</li>
</ul><div class="highlight highlight-javascript"><pre><span class="kd">var</span> <span class="nx">IOLIB</span> <span class="o">=</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">require</span> <span class="o">===</span> <span class="s1">'function'</span><span class="p">)</span> <span class="o">?</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'../'</span><span class="p">)</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">IOLIB</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">io</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">IOLIB</span><span class="p">.</span><span class="nx">IO</span><span class="p">({</span>
  <span class="nx">log</span><span class="o">:</span> <span class="kc">true</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">led</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">IOLIB</span><span class="p">.</span><span class="nx">Led</span><span class="p">({</span>
  <span class="nx">io</span><span class="o">:</span> <span class="nx">io</span><span class="p">,</span>
  <span class="nx">pin</span><span class="o">:</span> <span class="mi">13</span>
<span class="p">});</span>

<span class="nx">led</span><span class="p">.</span><span class="nx">blink</span><span class="p">();</span>

</pre></div>

<ul>
<li>RPC client which submits the IO request to IOT device. </li>
</ul><p>Only needs to add RPC options to IO constructor. The code works in nodejs or browser. </p>

<div class="highlight highlight-javascript"><pre><span class="kd">var</span> <span class="nx">io</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">IOLIB</span><span class="p">.</span><span class="nx">IO</span><span class="p">({</span>
  <span class="nx">log</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="nx">rpc</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="nx">port</span><span class="o">:</span> <span class="mi">2000</span><span class="p">,</span>
  <span class="nx">hostname</span><span class="o">:</span> <span class="s1">'localhost'</span><span class="p">,</span>
<span class="p">});</span>

</pre></div>

<ul>
<li>Offload execution</li>
</ul><p>The client can offload functions to remote server.</p>

<div class="highlight highlight-javascript"><pre><span class="kd">var</span> <span class="nx">IOLIB</span> <span class="o">=</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">require</span> <span class="o">===</span> <span class="s1">'function'</span><span class="p">)</span> <span class="o">?</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'..'</span><span class="p">)</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">IOLIB</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">io</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">IOLIB</span><span class="p">.</span><span class="nx">IO</span><span class="p">({</span>
  <span class="nx">log</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="nx">rpc</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="nx">port</span><span class="o">:</span> <span class="mi">2000</span><span class="p">,</span>
  <span class="nx">hostname</span><span class="o">:</span> <span class="s1">'localhost'</span><span class="p">,</span>
<span class="p">});</span>

<span class="nx">io</span><span class="p">.</span><span class="nx">offload</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">IOLIB</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">io</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">IOLIB</span><span class="p">.</span><span class="nx">IO</span><span class="p">({</span>
    <span class="nx">emu</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nx">log</span><span class="o">:</span> <span class="kc">true</span>
  <span class="p">});</span>
  <span class="kd">var</span> <span class="nx">led</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">IOLIB</span><span class="p">.</span><span class="nx">Led</span><span class="p">({</span>
    <span class="nx">io</span><span class="o">:</span> <span class="nx">io</span><span class="p">,</span>
    <span class="nx">pin</span><span class="o">:</span> <span class="mi">13</span>
  <span class="p">});</span>

  <span class="nx">led</span><span class="p">.</span><span class="nx">off</span><span class="p">();</span>

  <span class="nx">context</span><span class="p">.</span><span class="nx">save</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">});</span>

<span class="nx">io</span><span class="p">.</span><span class="nx">offloadQuery</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">response</span><span class="p">));</span>
<span class="p">});</span>
</pre></div>

<h2>
<a name="test" class="anchor" href="#test"><span class="octicon octicon-link"></span></a>Test</h2>

<p>We choose Buster.js to run tests in Nodejs and browser</p>

<p>Install buster.js</p>

<div class="highlight highlight-bash"><pre>npm install -g buster
</pre></div>

<p>Run test</p>

<div class="highlight highlight-bash"><pre>make <span class="nb">test</span>
</pre></div>

<h2>
<a name="arduino-library" class="anchor" href="#arduino-library"><span class="octicon octicon-link"></span></a>Arduino Library</h2>

<p>Go to target/device/libio</p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Io-js maintained by <a href="https://github.com/zliu9">zliu9</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
